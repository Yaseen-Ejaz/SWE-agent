{"model_name_or_path": "claude4__claude-sonnet-4-20250514__t-0.00__p-1.00__c-5.00___swe_bench_lite_test", "instance_id": "astropy__astropy-12907", "model_patch": "diff --git a/astropy/modeling/separable.py b/astropy/modeling/separable.py\nindex a308e2729..45bea3608 100644\n--- a/astropy/modeling/separable.py\n+++ b/astropy/modeling/separable.py\n@@ -242,7 +242,7 @@ def _cstack(left, right):\n         cright = _coord_matrix(right, 'right', noutp)\n     else:\n         cright = np.zeros((noutp, right.shape[1]))\n-        cright[-right.shape[0]:, -right.shape[1]:] = 1\n+        cright[-right.shape[0]:, -right.shape[1]:] = right\n \n     return np.hstack([cleft, cright])\n \ndiff --git a/astropy/modeling/tests/test_separable.py b/astropy/modeling/tests/test_separable.py\nindex 8dfe5c862..aebdee56a 100644\n--- a/astropy/modeling/tests/test_separable.py\n+++ b/astropy/modeling/tests/test_separable.py\n@@ -148,3 +148,53 @@ def test_custom_model_separable():\n \n     assert not model_c().separable\n     assert np.all(separability_matrix(model_c()) == [True, True])\n+\n+\n+def test_nested_compound_separability():\n+    \"\"\"\n+    Regression test for nested CompoundModel separability matrix computation.\n+    \n+    This test ensures that nested compound models produce the same separability\n+    matrix as their non-nested equivalents.\n+    \n+    See: https://github.com/astropy/astropy/issues/XXXX\n+    \"\"\"\n+    # Test the original issue from the PR description\n+    cm = models.Linear1D(10) & models.Linear1D(5)\n+    nested_model = models.Pix2Sky_TAN() & cm\n+    non_nested_model = models.Pix2Sky_TAN() & models.Linear1D(10) & models.Linear1D(5)\n+    \n+    nested_result = separability_matrix(nested_model)\n+    non_nested_result = separability_matrix(non_nested_model)\n+    \n+    expected = np.array([\n+        [True,  True, False, False],\n+        [True,  True, False, False],\n+        [False, False, True, False],\n+        [False, False, False, True]\n+    ])\n+    \n+    assert_allclose(nested_result, expected)\n+    assert_allclose(non_nested_result, expected)\n+    assert_allclose(nested_result, non_nested_result)\n+    \n+    # Test additional cases to ensure robustness\n+    # Both sides nested\n+    cm1 = models.Linear1D(1) & models.Linear1D(2)\n+    cm2 = models.Scale(3) & models.Scale(4)\n+    both_nested = cm1 & cm2\n+    non_nested_both = models.Linear1D(1) & models.Linear1D(2) & models.Scale(3) & models.Scale(4)\n+    \n+    both_nested_result = separability_matrix(both_nested)\n+    non_nested_both_result = separability_matrix(non_nested_both)\n+    \n+    expected_both = np.array([\n+        [True, False, False, False],\n+        [False, True, False, False],\n+        [False, False, True, False],\n+        [False, False, False, True]\n+    ])\n+    \n+    assert_allclose(both_nested_result, expected_both)\n+    assert_allclose(non_nested_both_result, expected_both)\n+    assert_allclose(both_nested_result, non_nested_both_result)\n"}